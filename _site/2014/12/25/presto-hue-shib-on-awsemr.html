<!DOCTYPE html>
<head>
  <meta http-equiv="Content-type" content="text/html; charset=utf-8">
  <meta name="google-site-verification" content="H6k1xpusWugwaQgJsWDpiTw4J_AGFZHR4shRsOvPI78" />
  <link rel="stylesheet" href="/assets/css/pure/0.3.0/pure-min.css">
  <link rel="stylesheet" href="/stylesheets/style.css">
  <link rel="stylesheet" href="/stylesheets/pygment_github.css">
  <title>AWS EMRでPrestoを動かしてshibからクエリ流してみる</title>
</head>
<body>
<header role='banner'>
    <h1 class="blog-title">包丁一本さらしに巻いて</h1>
    <nav role='navigation'>
        <div class="pure-menu pure-menu-open pure-menu-horizontal">
            <ul>
                <li class="pure-menu-selected"><a href="/">Top</a></li>
                <li class="pure-menu-selected"><a href="/about.html">About</a></li>
                <li class="pure-menu-selected"><a href="/feed.xml">Feed</a></li>
            </ul>
        </div>
    </nav>
</header>
<article class="text">
    <script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'achiku'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>

<div id="fb-root">
<script>
  window.fbAsyncInit = function() {
    // init the FB JS SDK
    FB.init({
      appId      : '1447639612119183',                   // App ID from the app dashboard
      status     : true,                                 // Check Facebook Login status
      xfbml      : true                                  // Look for social plugins on the page
    });

    // Additional initialization code such as adding Event Listeners goes here
  };

  // Load the SDK asynchronously
  (function(){
     // If we've already installed the SDK, we're done
     if (document.getElementById('facebook-jssdk')) {return;}

     // Get the first script element, which we'll use to find the parent node
     var firstScriptElement = document.getElementsByTagName('script')[0];

     // Create a new script element and set its id
     var facebookJS = document.createElement('script'); 
     facebookJS.id = 'facebook-jssdk';

     // Set the new script's source to the source of the Facebook JS SDK
     facebookJS.src = '//connect.facebook.net/en_US/all.js';

     // Insert the Facebook JS SDK into the DOM
     firstScriptElement.parentNode.insertBefore(facebookJS, firstScriptElement);
   }());
</script>
</div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=1447639612119183";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div class='pure-menu-heading'>
    <h1>AWS EMRでPrestoを動かしてshibからクエリ流してみる</h1>
    <p>2014.12.25</p>
</div>
<div>
    <p><a href="http://qiita.com/advent-calendar/2014/distributedcomputing">Spark, SQL on Hadoop etc. Advent Calendar 2014</a>の最終日です。</p>

<h2 id="section">書くこと</h2>
<p>AWS EMR/S3 + Hive + Presto + Hue + Shibの環境を構築し、簡単にトライアルしてみる。</p>

<h2 id="presto">Prestoについて</h2>
<p>Facebookがオープンソースで開発しているMPP(Massively Parallel Processing)クエリエンジン。</p>

<ul>
  <li>本家: <a href="http://prestodb.io/">Presto - Distributed SQL Query Engine for Big Data</a></li>
  <li>TDさんのわかりやすい解説: <a href="http://treasure-data.hateblo.jp/entry/2014/07/10/150250">『Prestoとは何か，Prestoで何ができるか』</a></li>
</ul>

<p>同じ系統のクエリエンジン括りだとImpalaやApache DrillがOSSとして開発されている。MPPクエリエンジン/データベースの大まかな流れや種類、それぞれの使いドコロについてははコチラの記事が最高にまとまっていて参考になる。
<a href="http://repeatedly.github.io/ja/2014/07/mpp-on-hadoop-redshift-bigquery/">MPP on Hadoop, Redshift, BigQuery</a></p>

<p>Facebook以外にもNetfilixやTreasureData等、デカイデータ扱う企業がこぞって開発に参加している印象があり、開発のスピードが速く矢継ぎ早にリリースを繰り返し、リリース毎に便利になっていく。「商用DWHを置き換えっぞ」っていう気合の入った目標に見合うパフォーマンスに加え、SQL分析関数を早々に実装しANSI SQLを完コピしつつJSONも華麗に扱る上、既存Hadoopエコシステムとのつなぎ込み部分(HiveのDDL/メタストアを利用)や、RDBMSとのつなぎ込み部分(MySQL Connector等)含め、なんというか、本当にいつも大変お世話になっています。</p>

<h2 id="shib">shibについて</h2>
<p>PrestoとHiveにクエリを実行できるWebUI。最初はnodeで作られていて不思議だなーって思ったのですが、このエントリを読んでnodeを選んだ理由がわかり、かっこいいなーと思っております。</p>

<ul>
  <li>本家: <a href="https://github.com/tagomoris/shib">shib -WebUI for query engines: Hive and Presto</a></li>
  <li>なぜnodeか: <a href="http://d.hatena.ne.jp/tagomoris/20110805/1312536706">Node.jsなWebアプリでJobQueueなしにラクラク巨大処理を実行</a></li>
</ul>

<h2 id="aws-emr">AWS EMRについて</h2>

<p>AWSが提供するAPIで操作できるマネージドHadoop環境。APIを利用してHadoopクラスタを作成し、監視等もよしなにやってくれる。要らなくなったら消しておける。</p>

<ul>
  <li>本家: <a href="http://aws.amazon.com/jp/elasticmapreduce/">AWS Elastic MapReduce</a></li>
  <li>知る限り最強のEMR資料: <a href="https://media.amazonwebservices.com/AWS_Amazon_EMR_Best_Practices.pdf">Best Practices for Amazon EMR</a></li>
</ul>

<p>前置きが長くなるとアレなので早速awscliを利用し環境を構築。</p>

<h2 id="section-1">環境概要</h2>

<ul>
  <li>HadoopはEMRを使ってクラスタ起動</li>
  <li>AMI 3.3.1 (Hadoop Amazon 2.4.0, Hive 0.13.1)</li>
  <li>Hive/HueはEMRデフォルトの機能を使ってインストール</li>
  <li>Hiveメタストアは一旦ローカルで</li>
  <li>PrestoはEMRのBootstrap Actionを使ってインストール(v0.85)</li>
  <li>ShibはEMRのBootstrap Actionを使ってインストール(v0.3.8)</li>
  <li>S3上にあるファイルにPrestoからクエリを投げる</li>
  <li>S3からHDFS上にフラットファイルで持ってきてPrestoからクエリを投げる</li>
  <li>S3からHDFS上にORCファイルに変換して持ってきてPrestoからクエリを投げる</li>
</ul>

<h2 id="section-2">構築方法</h2>

<h3 id="aws-cli">AWS CLIの準備</h3>

<p>CUIからEMRのAPIを叩くためにawscliを利用します。Python若干古いけどとりあえず実行した環境は以下</p>

<ul>
  <li>Python 2.7.5</li>
  <li>virtualenv==1.10.1</li>
  <li>virtualenvwrapper==4.1.1</li>
  <li>awscli==1.6.10</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>$ mkvirtualenv emr
(emr)$ pip install awscli
(emr)$ pip freeze | grep awscli
awscli==1.6.10
(emr)$ mkdir ~/.awscli
(emr)$ cat &lt;&lt;-EOF &gt;&gt;  ~/.awscli/config
[profile development]
aws_access_key_id=&lt;development_access_key&gt;
aws_secret_access_key=&lt;development_secret_key&gt;
region=ap-northeast-1
EOF
(emr)$ cat &lt;&lt;-EOF &gt;&gt;  $VIRTUAL_ENV/bin/activate
export AWS_CONFIG_FILE=~/.awscli/config
export AWS_DEFAULT_PROFILE=development
source aws_zsh_completer.sh
EOF
</code></pre>
</div>

<h3 id="s3">S3に必要なプログラムを配置</h3>

<p>2014/12/25時点でPrestoの最新版は0.89ですが、0.86以降はJava8が必要で、EMRで立ち上げるAmazon Linuxに入っているJavaがJava7という都合上今回は0.85を利用して環境構築します。たぶんJava8入れて頑張ればできるはずですがサクッといきましょう。</p>

<p>今回使ったソースは以下</p>

<ul>
  <li><a href="https://repo1.maven.org/maven2/com/facebook/presto/presto-server/0.85/presto-server-0.85.tar.gz">presto-server-0.85.tar.gz</a></li>
  <li><a href="https://repo1.maven.org/maven2/com/facebook/presto/presto-cli/0.85/presto-cli-0.85-executable.jar">presto-cli-0.85-executable.jar</a></li>
  <li><a href="https://github.com/tagomoris/shib/tree/v0.3.8">shib v0.3.8</a></li>
</ul>

<p>上記をダウンロードし、適当なS3キーに配置しておきます。以下例。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ wget https://repo1.maven.org/maven2/com/facebook/presto/presto-server/0.85/presto-server-0.85.tar.gz
$ aws s3 cp presto-server-0.85.tar.gz s3://yourbucket/libs/
$ wget https://repo1.maven.org/maven2/com/facebook/presto/presto-cli/0.85/presto-cli-0.85-executable.jar
$ aws s3 cp presto-cli-0.85-executable.jar s3://yourbucket/libs/
$ wget https://github.com/tagomoris/shib/archive/v0.3.8.zip
$ unzip v0.3.8.zip &amp;&amp; mv shib-0.3.8 shib
$ tar cvfz shib.tar.gz shib
$ aws s3 cp v0.3.8.zip s3://yourbucket/libs/
</code></pre>
</div>

<h3 id="s3-1">S3に必要な設定ファイルを配置</h3>

<p>shibがPrestoにクエリするための設定ファイル。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>var servers = exports.servers = {
  listen: 3000,
  fetch_lines: 1000,   // lines per fetch in shib
  query_timeout: null, // shib waits queries forever
  setup_queries: [],
  storage: {
    datadir: './var'
  },
  engines: [
    { label: 'PrestoCluster',
      executer: {
        name: 'presto',
        host: 'localhost',
        port: 8080,
        catalog: 'hive',  // required configuration argument
        support_database: true,
        default_database: 'default'
      },
      monitor: null
    },
  ],
};
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>$ aws s3 cp shib-config.js s3://yourbucket/libs/
</code></pre>
</div>

<h3 id="s3bootstrap-action">S3に必要なBootstrap Actionを配置</h3>

<p>Bootstrap ActionとはEMRが管理するHadoopクラスタ構築時に差し挟める任意の処理です。HiveやPig等はデフォルトでEMRのAPIからインストールを指定できるのですが、それ以外のソフトウェアに関してはBootstrap Actionで指定してインストール、設定を行う事になります。</p>

<h4 id="prestobootstrap-action">PrestoのBootstrap Action</h4>
<p>こちらのAWS Labリポジトリにあるので流用します。</p>

<ul>
  <li><a href="https://github.com/awslabs/emr-bootstrap-actions">awslabs/emr-bootstrap-actions</a></li>
  <li><a href="https://github.com/awslabs/emr-bootstrap-actions/tree/master/presto">Presto BootstrapAction</a></li>
</ul>

<p>PrestoのBootstrap Actionはそんなオフィシャルにサポートしてはいないですが、READMEもちゃんと書いてあるし、そこまで複雑ではないので要件によっては自作も有りかなと思います。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ wget https://raw.githubusercontent.com/awslabs/emr-bootstrap-actions/master/presto/install-presto.rb
$ aws s3 cp install-presto.rb s3://yourbucket/libs/
</code></pre>
</div>

<h4 id="shibbootstrap-action">shibのBootstrap Action</h4>

<p>shibは公開されているBootstrap Actionが無いのでシェルを雑に書いた。プロセスの立ち上げ部分もnohupとバックグラウンド実行でペイっと起動してるだけなので本番運用に耐えれるしろものではないですが一旦これで。</p>

<ul>
  <li>install-shib.sh</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

<span class="nv">shib_tarball_path</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">config_file_path</span><span class="o">=</span><span class="nv">$2</span>

sudo yum -y update
sudo yum install -y git
sudo yum install -y nodejs npm --enablerepo<span class="o">=</span>epel

aws s3 cp <span class="k">${</span><span class="nv">shib_tarball_path</span><span class="k">}</span> /home/hadoop/shib.tar.gz
<span class="o">{</span>
  <span class="nb">cd</span> /home/hadoop <span class="o">&amp;&amp;</span> tar xvfz /home/hadoop/shib.tar.gz
  <span class="nb">cd</span> /home/hadoop/shib <span class="o">&amp;&amp;</span> npm install
<span class="o">}</span>
aws s3 cp <span class="k">${</span><span class="nv">config_file_path</span><span class="k">}</span> /home/hadoop/shib/config.js
<span class="o">{</span>
  <span class="nb">cd</span> /home/hadoop/shib <span class="o">&amp;&amp;</span> nohup npm start &amp;
<span class="o">}</span>
</code></pre>
</div>

<p>これも同様にS3にあげる。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ aws s3 cp install-shib.sh s3://yourbucket/libs/
</code></pre>
</div>

<h3 id="aws-cli-1">AWS CLIでクラスタ立ち上げ</h3>

<ul>
  <li>create-cluster.sh</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">#!/bin/bash</span>

aws emr create-cluster --ami-version 3.3.1 <span class="se">\</span>
    --name <span class="s2">"</span><span class="nv">$USER</span><span class="s2"> (AMI 3.3.1 Hive + Hue + Presto + shib) </span><span class="k">$(</span> date <span class="s1">'+%Y%m%d%H%M'</span> <span class="k">)</span><span class="s2">"</span> <span class="se">\</span>
    --tags <span class="nv">Name</span><span class="o">=</span>presto-on-emr <span class="nv">environment</span><span class="o">=</span>development <span class="se">\</span>
    --ec2-attributes <span class="nv">KeyName</span><span class="o">=</span>yourkey <span class="se">\</span>
    --applications <span class="nv">Name</span><span class="o">=</span>hive <span class="nv">Name</span><span class="o">=</span>hue <span class="se">\</span>
    --instance-groups file://./large-instance-setup.json <span class="se">\</span>
    --bootstrap-actions file://./bootstrap-presto.json <span class="se">\</span>
    --log-uri <span class="s1">'s3://yourbucket/jobflow_logs/'</span> <span class="se">\</span>
    --no-auto-terminate <span class="se">\</span>
    --use-default-roles <span class="se">\</span>
    --visible-to-all-users
</code></pre>
</div>
<p>※AWSアカウントによっては–use-default-rolesをつけているとPrestoからS3にクエリできない事があります。ご注意。</p>

<p>instance-groupとbootstrap-actionsは長くなったのでJSONファイルに切り出しています。内容は以下。</p>

<ul>
  <li>large-instance-setup.json</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>[
  {
     "Name": "emr-master-production",
     "InstanceGroupType": "MASTER",
     "InstanceCount": 1,
     "InstanceType": "m3.xlarge"
  },
  {
     "Name": "emr-core-production",
     "InstanceGroupType": "CORE",
     "InstanceCount": 2 ,
     "InstanceType": "m3.xlarge"
  }
]
</code></pre>
</div>

<ul>
  <li>bootstrap-presto.json</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>[
  {
    "Name": "Install/Setup Shib",
    "Path": "s3://yourbucket/libs/install-shib.sh",
    "Args": [
        "s3://yourbucket/libs/shib.tar.gz",
        "s3://yourbucket/libs/shib-config.js"
    ]
  },
  {
    "Name": "Install/Setup Presto",
    "Path": "s3://yourbucket/libs/install-presto.rb",
    "Args": [
        "--s3-path-to-presto-server-bin","s3://yourbucket/libs/presto-server-0.85.tar.gz",
        "--s3-path-to-presto-cli", "s3://yourbucket/libs/presto-cli-0.85-executable.jar"
    ]
  }
]
</code></pre>
</div>

<h2 id="shibhue">Shib/Hueアクセス方法</h2>

<h3 id="foxyproxyssh">FoxyProxyとSSHトネリングを利用</h3>
<p>FoxyProxyインストールしてXMLを設定。sshコマンドを使ってトネリング。</p>

<ul>
  <li>
    <p><a href="http://getfoxyproxy.org/">FoxyProxy - Firefox/Chrome</a></p>
  </li>
  <li>
    <p>sample-emr-proxy.xml</p>
  </li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;foxyproxy&gt;</span>
    <span class="nt">&lt;proxies&gt;</span>
        <span class="nt">&lt;proxy</span> <span class="na">name=</span><span class="s">"emr-socks-proxy"</span> <span class="na">id=</span><span class="s">"2322596116"</span> <span class="na">notes=</span><span class="s">""</span> <span class="na">fromSubscription=</span><span class="s">"false"</span> <span class="na">enabled=</span><span class="s">"true"</span> <span class="na">mode=</span><span class="s">"manual"</span> <span class="na">selectedTabIndex=</span><span class="s">"2"</span> <span class="na">lastresort=</span><span class="s">"false"</span> <span class="na">animatedIcons=</span><span class="s">"true"</span> <span class="na">includeInCycle=</span><span class="s">"true"</span> <span class="na">color=</span><span class="s">"#0055E5"</span> <span class="na">proxyDNS=</span><span class="s">"true"</span> <span class="na">noInternalIPs=</span><span class="s">"false"</span> <span class="na">autoconfMode=</span><span class="s">"pac"</span> <span class="na">clearCacheBeforeUse=</span><span class="s">"false"</span> <span class="na">disableCache=</span><span class="s">"false"</span> <span class="na">clearCookiesBeforeUse=</span><span class="s">"false"</span> <span class="na">rejectCookies=</span><span class="s">"false"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;matches&gt;</span>
                <span class="nt">&lt;match</span> <span class="na">enabled=</span><span class="s">"true"</span> <span class="na">name=</span><span class="s">"*ec2*.amazonaws.com*"</span> <span class="na">pattern=</span><span class="s">"*ec2*.amazonaws.com*"</span> <span class="na">isRegEx=</span><span class="s">"false"</span> <span class="na">isBlackList=</span><span class="s">"false"</span> <span class="na">isMultiLine=</span><span class="s">"false"</span> <span class="na">caseSensitive=</span><span class="s">"false"</span> <span class="na">fromSubscription=</span><span class="s">"false"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;match</span> <span class="na">enabled=</span><span class="s">"true"</span> <span class="na">name=</span><span class="s">"*ec2*.compute*"</span> <span class="na">pattern=</span><span class="s">"*ec2*.compute*"</span> <span class="na">isRegEx=</span><span class="s">"false"</span> <span class="na">isBlackList=</span><span class="s">"false"</span> <span class="na">isMultiLine=</span><span class="s">"false"</span> <span class="na">caseSensitive=</span><span class="s">"false"</span> <span class="na">fromSubscription=</span><span class="s">"false"</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;match</span> <span class="na">enabled=</span><span class="s">"true"</span> <span class="na">name=</span><span class="s">"10.*"</span> <span class="na">pattern=</span><span class="s">"http://10.*"</span> <span class="na">isRegEx=</span><span class="s">"false"</span> <span class="na">isBlackList=</span><span class="s">"false"</span> <span class="na">isMultiLine=</span><span class="s">"false"</span> <span class="na">caseSensitive=</span><span class="s">"false"</span> <span class="na">fromSubscription=</span><span class="s">"false"</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/matches&gt;</span>
            <span class="nt">&lt;manualconf</span> <span class="na">host=</span><span class="s">"localhost"</span> <span class="na">port=</span><span class="s">"8157"</span> <span class="na">socksversion=</span><span class="s">"5"</span> <span class="na">isSocks=</span><span class="s">"true"</span> <span class="na">username=</span><span class="s">""</span> <span class="na">password=</span><span class="s">""</span> <span class="na">domain=</span><span class="s">""</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/proxy&gt;</span>
    <span class="nt">&lt;/proxies&gt;</span>
<span class="nt">&lt;/foxyproxy&gt;</span>
</code></pre>
</div>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ssh -i ~/yourkey.pem -ND 8157 hadoop@youremrhost.compute.amazonaws.com
</code></pre>
</div>

<p>これでFoxyProxyがインストールされているブラウザを介すると、以下のURLにアクセスするとShibにアクセスできます。</p>

<ul>
  <li>http://youremrhost.compute.amazonaws.com:3000</li>
</ul>

<p>また、以下のURLにアクセスするとHueにアクセスできます。</p>

<ul>
  <li>http://youremrhost.compute.amazonaws.com:8888</li>
</ul>

<h3 id="aws-securitygroup">AWS SecurityGroupを変更</h3>
<p>EMRのMasterノードに付与されるSecurityGroupにオフィスのIPからの3000/8888を許可する。これはIPアドレスでのアクセス制限はできますが、通信自体は暗号化されずにHTTPでやりとりされるのであまりお勧めしません。</p>

<h2 id="section-3">パフォーマンス</h2>
<p>パフォーマンスもやりたかった。。S3とHDFS FlatFileとHDFS ORCでかなり差がでるのでたぶん後ほど追記します。</p>

<h2 id="section-4">終わりに</h2>
<p>いかがでしたでしょうか。
PrestoとEMRはまだそんなにビッグじゃないけど、大きくなりそうなデータに対して、インタラクティブクエリとスケールしやすさを与えてくれるいいコンビなんじゃないかなと思っております。
もうあと25日は2時間しか残ってませんがハッピーメリークリスマス！</p>


</div>
<div class="post-sharing">
  <a href="https://twitter.com/share" class="twitter-share-button" data-via="_achiku" style="display: inline-block; vertical-align: bottom;">Tweet</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
  <a class="fb-like" data-href="" data-layout="button_count" data-action="like" data-show-faces="true" data-share="true" style="display: inline-block"></a>
</div>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'achiku'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

</article>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-50431971-1', 'akirachiku.com');
  ga('send', 'pageview');

</script>
</body>
